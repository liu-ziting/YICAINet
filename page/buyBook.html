<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>医采网-购买标书</title>
		<link rel="stylesheet" href="../layui/css/layui.css" />
		<link rel="stylesheet" href="../css/index.css" />
	</head>

	<body>
		<!--头部-->
		<header>
			<div class="htop">
				<div class="centered">
					<div class="left">
						<p>欢迎来到医采网！</p>
						<img class="loginIcon" src="../img/user.png" />
						<span class="topLoginBox">
							<a class="login" href="login.html">登录 &nbsp;&nbsp;|</a>
							<a class="register" href="register.html">免费注册</a>
							<a class="userTop" href="user.html">个人中心</a>
						</span>
					</div>
					<div class="right">
						<img src="../img/iPhone.png" />
						<p>免费咨询热线：0550-3022569</p>
						<span>|</span>
						<p onclick="addFavorite()">收藏 </p>
						<span>|</span>
						<p>帮助</p>
					</div>
				</div>
			</div>
			<div class="searchBox">
				<div class="centered">
					<a class="logo" href="../index.html">
						<img src="../img/logo.png" />
					</a>
					<!--搜索-->
					<div class="rightBox">
						<div class="toptab">
							<span class="active">查询药品</span>
							<span>查询耗材</span>
						</div>
						<div class="search">
							<input type="text" name="title" required lay-verify="required" placeholder="请输入搜索关键词" autocomplete="off" class="layui-input">
							<span>
								<img src="../img/ss.png" />
							</span>
						</div>
					</div>
				</div>
			</div>
			<!--导航-->
			<nav>
				<div class="centered">
					<ul>
						<li onclick="openUrl('../index.html')">首页</li>
						<li class="active" onclick="openUrl('callForBids.html')">招标采购信息</li>
						<li onclick="openUrl('drugList.html')">药品信息</li>
						<li onclick="openUrl('materialsList.html')">耗材信息</li>
						<li onclick="openUrl('facilityList.html')">设备信息</li>
						<li onclick="openUrl('policy.html')">政策法规</li>
						<li onclick="openUrl('download.html')">下载中心</li>
					</ul>
				</div>
			</nav>
		</header>
		<div class="buyBook centered">
			<ul>
			    <li>
		    		<span>标书名称：</span>
		    		<p id="title"></p>
		    		<b id="realPrice"></b>
			    </li>
			    <li>
		    		<span>支付方式：</span>
		    		<div class="wechat">
		    			<i class="wicon"></i>
		    			<span>微信</span>
		    			<input type="hidden" class="payChannel" value="wechat_pay_pc" />
		    		</div>
		    		<div class="alipay">
		    			<i class="zicon"></i>
		    			<span>支付宝</span>
		    			<input type="hidden" class="payChannel" value="ali_pay_pc" />
		    		</div>
			    </li>
			    <li id="wxPayBox" style="display: none;">
			    	<div class="qrcode">
			    		<img src="../img/qrcode.png" />
			    	</div>
			    	<p>请扫描二维码进行付款</p>
			    	<div class="bottomImg">
			    		<img src="../img/wx3.png" />
			    		<img src="../img/zfb3.png" />
			    	</div>
			    	<em>推荐使用微信、支付宝支付</em>
			    </li>
			    <!--支付宝支付跳转-->
			    <div id="alipayBox"></div>
			</ul>
		</div>
		<div class="centered main">
			<!--广告-->
			<div class="advertisement">
				<a href="#">
					<img src="../img/temporary/gg.png" />
					<span>广告</span>
				</a>
			</div>
		</div>
		
		<div id="footer"></div>
		
		<script type="text/javascript" src="../js/jquery-3.4.1.min.js"></script>
		<script type="text/javascript" src="../layui/layui.all.js"></script>
		<script type="text/javascript" src="../js/main.js"></script>
		<script>
			//支付切换
			$(".buyBook ul li:nth-child(2) div").click(function(){
				$(this).addClass("active").siblings().removeClass("active");
				getPayInfo();	
			});
			
			//获取标书详情和金额
			getResource();
			function getResource(){
				http.ajax({
					url: 'resource/get_resource',
					type: 'GET',
					json: false,
					mask: true,
					data: {
						id:getQueryString("id")
					}
				}).then(function(data) {
					if(data.code == 200) {
						$("#title").text(data.data.title);
						$("#realPrice").text("￥"+data.data.realPrice);
					}
				}, function(err) {
					
				})
			};
			
			//支付接口
			function getPayInfo(){
				var payChannel = $(".buyBook ul li:nth-child(2) .active .payChannel").val();
				http.ajax({
					url: 'goods/get_pay_info',
					type: 'GET',
					json: false,
					mask: true,
					data: {
						id:getQueryString("id"),
						payChannel:payChannel,
						operationType:getQueryString("operationType"),
						terminalType:'pc'
					}
				}).then(function(data) {
					if(data.code == 200) {
						if(payChannel == 'ali_pay_pc'){
							var json = JSON.parse(data.data);
							$("#alipayBox").append(json.payUrl);
						}else if(payChannel == 'wechat_pay_pc'){
							$("#wxPayBox").show()
						};
					}
				}, function(err) {
					
				})
			};
		</script>
	</body>

</html>